variables:
  gopath: echo $GOPATH
  version: echo v0.2

options:
  shell: /bin/bash

blocks:
  default:
    # deps: '{gopath}/bin/gogitserver'
    cmd: go install github.com/nananas/gogitserver
    post: debug

  run:
    cmd: '{gopath}/bin/gogitserver'

  debug:
    cmd: '{gopath}/bin/gogitserver -d'

  package:
    cmd:
      - mkdir -p ./package/{static,templates}
      - cp '{gopath}/bin/gogitserver' ./package
      - cp ./static/styling.css ./package/static
      - cp ./templates/tree.html ./templates/index.html ./package/templates
      - cp LICENSE README.md ./package

      - cd package && tar -cvf ../gogitserver_{version}_linux_amd64.tar.gz *
  clean:
    cmd:
      - rm -r ./package
      - rm ./gogitserver_*_linux_amd64.tar.gz

